# ============================================================================
# Rate Limiting Configuration
# This file is included at HTTP level in nginx configuration
# ============================================================================

# Zone: 10 requests per second per IP (with burst of 20)
limit_req_zone $binary_remote_addr zone=general_limit:10m rate=10r/s;

# Zone: 5 requests per minute for login/auth endpoints (prevents brute force)
limit_req_zone $binary_remote_addr zone=auth_limit:10m rate=5r/m;

# Zone: 30 requests per second for API endpoints
limit_req_zone $binary_remote_addr zone=api_limit:10m rate=30r/s;

# Connection limit: max 10 concurrent connections per IP
limit_conn_zone $binary_remote_addr zone=conn_limit:10m;

# Return 429 status code when rate limit is exceeded
limit_req_status 429;
limit_conn_status 429;
